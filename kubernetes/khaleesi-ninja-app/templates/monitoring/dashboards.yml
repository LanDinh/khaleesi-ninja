apiVersion: "v1"
kind: "ConfigMap"
metadata:
  name: "grafana-dashboards-khaleesi-{{ .Values.environment.name }}-{{ .Values.site.name }}-{{ .Values.app.name }}"
  namespace: "khaleesi-monitoring"
  labels:
    khaleesi-ninja: "environment"
    environment: "{{ .Values.environment.name }}"
    site: "{{ .Values.site.name }}"
    app: "{{ .Values.app.name }}"
    infrastructure: "grafana"
    grafana_dashboard: "1"
  annotations:
    khaleesi_folder: "khaleesi/{{ .Values.environment.name }}"
data:
  {{ .Values.site.name }}-{{ .Values.app.name }}.json: |
  {{- tpl ($.Files.Get "data/grafana-dashboards/app.json") $ | nindent 4 }}
