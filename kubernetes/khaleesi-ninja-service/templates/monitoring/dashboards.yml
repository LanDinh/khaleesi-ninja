apiVersion: "v1"
kind: "ConfigMap"
metadata:
  name: "grafana-dashboards-khaleesi-{{ .Values.environment.name }}-{{ .Values.gate.name }}-{{ .Values.service.name }}"
  namespace: "khaleesi-monitoring"
  labels:
    khaleesi-ninja: "environment"
    environment: "{{ .Values.environment.name }}"
    gate: "{{ .Values.gate.name }}"
    service: "{{ .Values.service.name }}"
    infrastructure: "grafana"
    grafana_dashboard: "1"
  annotations:
    khaleesi_folder: "khaleesi/{{ .Values.environment.name }}"
data:
  {{ .Values.gate.name }}-{{ .Values.service.name }}.json: |
  {{- tpl ($.Files.Get "data/grafana-dashboards/service.json") $ | nindent 4 }}
