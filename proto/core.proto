syntax = "proto3";

package khaleesi.core;

import "google/protobuf/timestamp.proto";


message User {
  enum UserType {
    // Non human.
    UNKNOWN       = 0;
    SYSTEM        = 1;

    // Human.
    ANONYMOUS     = 10;
    AUTHENTICATED = 11;
    PRIVILEGED    = 12;
  }

  string   id   = 1;
  UserType type = 2;
}

message GrpcCallerDetails {
  string request_id       = 1;
  string khaleesi_gate    = 2;
  string khaleesi_service = 3;
  string grpc_service     = 4;
  string grpc_method      = 5;
}

message RequestMetadata {
  // Set by calling service.
  GrpcCallerDetails         caller           = 1;
  User                      user             = 2;
  google.protobuf.Timestamp timestamp        = 3;

  // Response-only fields.
  google.protobuf.Timestamp logged_timestamp = 10;
}
